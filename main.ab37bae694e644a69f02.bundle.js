(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{zUnb:function(t,e,n){"use strict";n.r(e);var i=function(){function t(t){var e=this;this.engine=t,this._accumulatedTime=0,this._lastTime=0,this._animationFrameCallBack=function(t){return e._loop(t)}}return t.prototype.start=function(){this._animationFramehandle=requestAnimationFrame(this._animationFrameCallBack)},t.prototype.stop=function(){cancelAnimationFrame(this._animationFramehandle)},t.prototype._loop=function(t){var e=(t-this._lastTime)/1e3;for(this._accumulatedTime+=e,this._fps=Math.round(1/e);this._accumulatedTime>1/60;)this.engine.update(1/60),this._accumulatedTime-=1/60;this.engine.renderer(),this._lastTime=t,this._animationFramehandle=requestAnimationFrame(this._animationFrameCallBack)},Object.defineProperty(t.prototype,"fps",{get:function(){return this._fps},enumerable:!0,configurable:!0}),t}(),o=function(){function t(){this._layers={}}return t.prototype.addLayer=function(t,e){this._layers[t]=e},t.prototype.removeLayer=function(t){delete this._layers[t]},t.prototype.update=function(t){var e=this;Object.keys(this._layers).forEach((function(n){return e._layers[n].update(t)}))},t.prototype.renderer=function(t){var e=this;Object.keys(this._layers).forEach((function(n){return e._layers[n].renderer(t)}))},t}(),r=function(){function t(){}return t.prototype.update=function(t){},t.prototype.renderer=function(t){t.beginPath(),t.fillStyle="black",t.fillRect(0,0,t.canvas.width,t.canvas.height),t.closePath()},t}(),s=function(){function t(t){this.name=t}return t.values=function(){return[t.LEFT,t.TOP,t.RIGHT,t.BOTTOM]},t.LEFT=new t("LEFT"),t.TOP=new t("TOP"),t.RIGHT=new t("RIGHT"),t.BOTTOM=new t("BOTTOM"),t}(),c=function(){function t(t,e){this.x=t,this.y=e}return t.fromPosition=function(e){return new t(e.x,e.y)},t.prototype.distance=function(t){return Math.sqrt(this.squareDistance(t))},t.prototype.squareDistance=function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},t.prototype.draw=function(t){t.fillRect(this.x,this.y,1,1)},t}(),h=function(){function t(t,e){this.position=t,this.radius=e}return Object.defineProperty(t.prototype,"center",{get:function(){return c.fromPosition(this.position)},enumerable:!0,configurable:!0}),t.prototype.draw=function(t){t.beginPath(),t.arc(this.position.x,this.position.y,this.radius,0,2*Math.PI),t.stroke(),t.closePath()},t}(),a=function(){function t(t,e,n,i){this.x=t,this.y=e,this.width=n,this.height=i}return t.prototype.draw=function(t){t.beginPath(),t.rect(this.x,this.y,this.width,this.height),t.stroke(),t.closePath()},t}(),u=function(){function t(t){this.delegate=t}return t.prototype.checkTop=function(t,e){return this.delegate.checkTop(e,t)},t.prototype.checkBottom=function(t,e){return this.delegate.checkBottom(e,t)},t.prototype.checkLeft=function(t,e){return this.delegate.checkLeft(e,t)},t.prototype.checkRight=function(t,e){return this.delegate.checkRight(e,t)},t}(),p=function(){function t(){}return t.prototype.checkTop=function(t,e){throw new Error("Method not implemented.")},t.prototype.checkBottom=function(t,e){throw new Error("Method not implemented.")},t.prototype.checkLeft=function(t,e){throw new Error("Method not implemented.")},t.prototype.checkRight=function(t,e){throw new Error("Method not implemented.")},t}(),f=function(){function t(){}return t.prototype.checkTop=function(t,e){throw new Error("Method not implemented.")},t.prototype.checkBottom=function(t,e){throw new Error("Method not implemented.")},t.prototype.checkLeft=function(t,e){throw new Error("Method not implemented.")},t.prototype.checkRight=function(t,e){throw new Error("Method not implemented.")},t}(),d=function(){function t(){}return t.prototype.checkTop=function(t,e){var n=e.y;return t.center.y-t.radius<=n&&n<=t.center.y+t.radius&&e.x<=t.center.x+t.radius&&e.x+e.width>=t.center.x-t.radius},t.prototype.checkBottom=function(t,e){var n=e.y+e.height;return t.center.y-t.radius<=n&&n<=t.center.y+t.radius&&e.x<=t.center.x+t.radius&&e.x+e.width>=t.center.x-t.radius},t.prototype.checkLeft=function(t,e){var n=e.x;return t.center.x-t.radius<=n&&n<=t.center.x+t.radius&&e.y<=t.center.y+t.radius&&e.y+e.height>=t.center.y-t.radius},t.prototype.checkRight=function(t,e){var n=e.x+e.width;return t.center.x-t.radius<=n&&n<=t.center.x+t.radius&&e.y<=t.center.y+t.radius&&e.y+e.height>=t.center.y-t.radius},t}(),l=[{s1:h,s2:a,collider:new d},{s1:h,s2:h,collider:new p},{s1:a,s2:a,collider:new f}],y=function(){function t(t){this.entities=t}return t.prototype.check=function(){for(var t=0;t<this.entities.length;t++)for(var e=this.entities[t],n=0;n<this.entities.length;n++)t!=n&&this._checkCollision(e,this.entities[n])},t.prototype._checkCollision=function(t,e){var n=this,i=t.collisionShape,o=e.collisionShape,r=this._findCollider(i,o);s.values().forEach((function(s){n._findCheckFct(r,s).bind(r)(i,o)&&t.collides(e,s)}))},t.prototype._findCollider=function(t,e){var n=l.find((function(n){return t instanceof n.s1&&e instanceof n.s2||t instanceof n.s2&&e instanceof n.s1}));return t instanceof n.s1?n.collider:new u(n.collider)},t.prototype._findCheckFct=function(t,e){switch(e){case s.TOP:return t.checkTop;case s.BOTTOM:return t.checkBottom;case s.LEFT:return t.checkLeft;case s.RIGHT:return t.checkRight}},t}(),m=function(){function t(t){this.entities=t}return t.prototype.update=function(t){this.entities.forEach((function(e){return e.update(t)}))},t.prototype.renderer=function(t){this.entities.forEach((function(e){return e.renderer(t)}))},t}(),_=function(){function t(t,e){void 0===e&&(e={x:-50,y:16}),this.fpsSupplier=t,this.offset=e}return t.prototype.update=function(t){},t.prototype.renderer=function(t){t.fillStyle="white",t.font="16px",t.fillText("FPS: "+this.fpsSupplier(),t.canvas.width+this.offset.x,this.offset.y)},t}(),w=function(){function t(t){this.entities=t}return t.prototype.update=function(t){},t.prototype.renderer=function(t){t.strokeStyle="red",t.fillStyle="red",this.entities.map((function(t){return t.collisionShape})).forEach((function(e){return e.draw(t)}))},t}(),g=function(){function t(t){var e=this;this._layers=new o,this._entities=[];var n=document.createElement("canvas");document.body.appendChild(n),n.width=t.canvasSize.width,n.height=t.canvasSize.height,this._graphics=n.getContext("2d"),this._layers.addLayer("clear",new r),this._layers.addLayer("entities",new m(this._entities)),this._layers.addLayer("collision",new w(this._entities)),this._layers.addLayer("fps",new _((function(){return e._gameLoop.fps}))),this._collider=new y(this._entities),this._gameLoop=new i(this)}return t.prototype.start=function(){this._gameLoop.start()},t.prototype.stop=function(){this._gameLoop.stop()},t.prototype.addLayer=function(t,e){this._layers.addLayer(t,e)},t.prototype.removeLayer=function(t){this._layers.removeLayer(t)},t.prototype.addEntity=function(t){this._entities.push(t)},t.prototype.removeEntity=function(t){this._entities.slice(this._entities.indexOf(t))},t.prototype.update=function(t){this._collider.check(),this._layers.update(t)},t.prototype.renderer=function(){this._layers.renderer(this._graphics)},t}(),v=function(){function t(t,e,n,i){this.x=t,this.y=e,this.width=n,this.height=i,this.collisionShape=new a(t,e,n,i)}return t.prototype.renderer=function(t){},t.prototype.update=function(t){},t.prototype.collides=function(t,e){console.log(this,"collides with ",t,e)},t}(),k=function(){function t(t,e){this._radius=20,this._velocity={x:100*(Math.random()>.5?1:-1),y:100*(Math.random()>.5?1:-1)},this.position={x:t,y:e}}return t.prototype.update=function(t){this.position.x+=this._velocity.x*t,this.position.y+=this._velocity.y*t},t.prototype.renderer=function(t){t.fillStyle="white",this.collisionShape.draw(t),t.fill()},Object.defineProperty(t.prototype,"collisionShape",{get:function(){return new h(this.position,this._radius)},enumerable:!0,configurable:!0}),t.prototype.collides=function(t,e){console.log(this,"collides with ",t,e),t instanceof v&&(e==s.RIGHT||e==s.LEFT?this._velocity.x=-1*this._velocity.x:e!=s.TOP&&e!=s.BOTTOM||(this._velocity.y=-1*this._velocity.y))},t}();(new(function(){function t(){this._gameEngine=new g(this);var t=new k(this.canvasSize.width/2,this.canvasSize.height/2);this._gameEngine.addEntity(new v(10,10,this.canvasSize.width-20,this.canvasSize.height-20)),this._gameEngine.addEntity(t)}return t.prototype.start=function(){this._gameEngine.start()},t.prototype.stop=function(){this._gameEngine.stop()},Object.defineProperty(t.prototype,"canvasSize",{get:function(){return{width:800,height:600}},enumerable:!0,configurable:!0}),t}())).start()}},[["zUnb",1]]]);
//# sourceMappingURL=main.ab37bae694e644a69f02.bundle.js.map